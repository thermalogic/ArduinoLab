# 使用74HC595扩展端口的小车

**TODO**

* 超声 - 暂时没有使用

## 背景

速度测试如果用中断，Arduino UNO只能用2，3，但是，现在只空余1和2，3已经被使用无法左右都测速，

使用74HC595输出控制：左右电机（IN1-IN4),2个LED，可以多出3个Pin

电机的PWM不适宜使用74HC595，因为74HC595的OE控制了`所有`输出的PWM


## 代码

* 加入IR： Lab_2WD_10_2_74HC595_IR.ino
* 加入softserial Lab_2WD_10_3_74HC595_IR_Web.ino

Arduino UNO和Pro Mini都通过 

Pro Mini连接电机通过

**解决问题：** 红外不稳定，原因是ESP8266太近，板子电源红色光，信号干扰 

需要注意：红外接收器在板子上的位置，不适靠近LED光源，特别是红色

## 端口安排

目前空余：12，13

**74HC595**

* latchPin： RCLK (Register Clock / Latch) (12) -> Arduino D3(黄色)
* clockPin: SRCLK (Shift Register Clock) (11)    -> Arduino D4（白色）
* dataPin: SER (Serial Input)(14)  -> Arduino D2(绿色)

**LED**

```c
// 74hc595 黄色
#define LED_LEFT 5 
#define LED_RIGHT 6
```

**IR**

* IR out ->Arduino D7（白色）

**LN298N**

```c
// 74hc595
#define MOTOR_LEFT_FORWARD 4 // 黄色->蓝色
#define MOTOR_LEFT_BACK 3   //蓝色->蓝色
#define MOTOR_RIGHT_FORWARD 1 //紫色->灰色
#define MOTOR_RIGHT_BACK 2  //棕色->灰色
//Arduino 绿色
#define leftPWM 6
#define rightPWM 5
```

**SofSerial**
Arduino

```c
#define SS_RX 10 (黄色)  
#define SS_TX 11（蓝色）
```

**超声** - 暂时没有使用
Arduino
```c
int trigPin = 8;    // Trigger
int echoPin = 9;    // Echo
```
